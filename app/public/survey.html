<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Friends Page</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="jumbotron">
            <h1 class="text-center"> Foodie Friends Survey</h1>
            <hr>
            <h2 class="text-center">Please feel free to fill in all of the below info related to food, so you can find a true foodie friend </h2>
            <br>
            <div class="row">
                <div class="col-lg-12">
                </div>
            </div>
        </div>
        <div class="form-group row">
            <label for="example-text-input" class="col-2 col-form-label">Name</label>
            <div class="col-10">
                <input class="form-control" type="text" value="" id="name" required>
            </div>
            <div class="form-group row">
                <label for="example-text-input" class="col-2 col-form-label">Link to Photo Image</label>
                <div class="col-10">
                    <input class="form-control" type="text" value="" id="photo" required>
                </div>
                <h2>Question 1</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How likely are you to go on a diet?</label>
                    <select class="form-control" id="question1">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 2</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many pounds of food do you have daily?</label>
                    <select class="form-control" id="question2">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 3</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many pounds of chocolate could you eat at once?</label>
                    <select class="form-control" id="question3">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 4</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many meals do you have a day?</label>
                    <select class="form-control" id="question4">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 5</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many snacks do you have a day</label>
                    <select class="form-control" id="question5">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 6</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many times do you eat out a week?</label>
                    <select class="form-control" id="question6">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 7</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How high would you rate Gordon Ramsay?</label>
                    <select class="form-control" id="question7">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 8</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many pancakes do you have in a short stack?</label>
                    <select class="form-control" id="question8">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 9</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many licks do you take from a lollipop before you chomp on it?</label>
                    <select class="form-control" id="question9">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <h2>Question 10</h2>
                <div class="form-group">
                    <label for="exampleSelect2">How many spices do you put on your food daily?</label>
                    <select class="form-control" id="question10">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <!--   <div class="text-center">
        <a href="/reserve"><button type="button" class="btn btn-lg btn-danger" id="submit">  Submit </button></a>
      </div> -->
                <div class="container">
                    <!-- Trigger the modal with a button -->
                    <button type="button" class="btn btn-info btn-lg" id="submit" data-toggle="modal" data-target="#friend-modal">Submit</button>
                </div>
                <!-- Modal -->
                <!-- <div class="modal fade" id="myModal" id="friend-modal" role="dialog">
    <div class="modal-dialog"> -->
                <!-- Modal content-->
                <!-- <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Foodie Friend Match</h4>
        </div>
        <p>Here is the most compatible foodie for you:</p>
        <div class="modal-body">
        </div>
        <div id ="friend-modal"></div>
        <div id ="h4"></div>

        <img id="friends-photo">
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div> -->
                <!-- Modal -->
                <div class="modal fade" id="friend-modal" role="dialog">
                    <div class="modal-dialog">
                        <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title"></h4>
                            </div>
                            <div class="modal-body">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <br>
                    <br>
                </div>
            </div>
</body>

</html>
<footer class="footer">
    <div class="container">
        <p> <a href="/api/friends">API Friends List</a> | <a href="https://github.com/nicothegeeko/FriendFinder-HW-13.git">GitHub Repo</a></p>
    </div>
</footer>
</body>
<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS LOADED FROM OUR SERVER -->
<script type="text/javascript">
$("#submit").on("click", function(event) {
    event.preventDefault();
    var scores = [];
    $('select', '.container').each(function() {
        scores.push($(this).val());
    });
    var newFriend = {
        name: $("#name").val().trim(),
        photo: $("#photo").val().trim(),
        scores: scores
    };

    // Question: What does this code do??
    $.post("/api/friends", newFriend)
        .done(function(data) {
            console.log(data);
        });
    console.log(newFriend);
});

// In this code, jQuery is used to "download" the data from our server
// We then dynamically display this content in our table. This is very similar to the group projects you just completed.
// It's also very similar to the NYT search application. In fact, I copied a ton of code from there.

// function runFriendQuery() {

// Here we get the location of the root page.
// We use this instead of explicitly saying the URL is localhost:3001 because the url will change when we deploy.
var currentURL = window.location.origin;

// The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
$.ajax({
        url: currentURL + "/api/friends",
        method: "GET"
    }).done(function(res) {

        // // Loop through and display each of the customers
        // // for (var i = 0; i < friends.length; i++) {
        //   $("friends").html(friends[0].name);
        //   $("friends").attr("src", friends[0].photo);

        var foodieFriend;
        var bestMatch = 100;
        var differenceArray = [];
        //loops through all friends with the exception of the one just created
        for (i = 0; i < res.length - 1; i++) {
            //compares the values from the survey questions and pushes the absolute value of the differences to the difference array
            for (j = 0; j < 10; j++) {
                var currentDifference = newFriend.scores[j] - res[i].scores[j];
                differenceArray.push(Math.abs(currentDifference));
            }
            //adds the values in the array to give a single value that represents the difference between a potential friend and the current entry
            var difference = differenceArray.reduce(add, 0);
            //if the difference is less than any of the previous comparisons, push the current profile to the best match position
            if (difference < bestMatch) {
                foodieFriend = res[i];
                bestMatch = difference;
                differenceArray = [];
            }
            //or just move on
            else {
                differenceArray = [];
            }

        }
      }

        //set up the display for the modal
        var friendName = '<h4>' + foodieFriend.name + '<h4>';
        var friendPic = '<img width="300px" src=' + foodieFriend.photo + '>';
        //show the modal
        $('#friend-modal').modal('show');
        $('#friend-modal h4').html(friendName);
        $('.modal-body').html(friendPic);
        //clear the entries
        $('#survey')[0].reset();

    });
// }
</script>

</html>
